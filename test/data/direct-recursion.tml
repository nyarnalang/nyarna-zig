=== Direct Recursion
--- input
\declare:
  foo = \func:
    recurse       : \Boolean
    before, after : \Raw
  :body:
    \before\if(\recurse, \foo(false, two, three))\after
  \end(func)
\end(declare)

\foo(true, one, four)
\foo(false, one, two)
--- expr
+CALL
  =FUNCREF .doc.document.foo
  >ARG recurse
  =ENUM Boolean "true"
  >ARG before
  =TEXT raw "one"
  >ARG after
  =TEXT raw "four"
-CALL
=TEXT raw "\n"
+CALL
  =FUNCREF .doc.document.foo
  >ARG recurse
  =ENUM Boolean "false"
  >ARG before
  =TEXT raw "one"
  >ARG after
  =TEXT raw "two"
-CALL
--- document
=RAW Raw "onetwothreefour\nonetwo"